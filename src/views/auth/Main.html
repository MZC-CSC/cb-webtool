{{ template "Top" .}}
	
		<div id="lnb">
			
			<div class="bg"></div>
				
			<div class="m_box">
				
				{{template "TopBox" .}}

				{{template "LNBPopup" .}}
				
				<!-- menu -->
				{{template "MenuLeft" .}}
				<!-- //menu -->				
			</div>
			
			<div class="bottom"></div>
			<a href="javascript:;" id="m_close"></a>
			
		</div>
			
		{{template "Header" .}}
	
		{{template "Modal" .}}
				
				<!-- contents -->
				<div class="contbox">
					
					<div class="titlebox">
						<div class="tit"><img src="/assets/img/common/icon_cont.png" alt=""/>Main</strong></div>
						<div class="location">Home  <span>></span> <strong>Main</strong></div>
					</div>

					<!-- list -->
					<div class="dashboard dashboard_cont">
						<div class="wbox">
                        
                            <!-- Select NS (NameSpace) -->
                            <div class="popbox popboxNS">
                                <div class="popcont">
                                    <div class="titlebox">
                                        <div class="tit"><span>Select NS</span> (NameSpace)</div>
                                        <div class="txt">사용자의 작업 영역을 선택 또는 생성해 주세요</div>
                                    </div>
                                
                                    <!-- list -->
                                    <div class="cloudlist">
                                        <div class="listbox scrollbar-inner" id="nsList">                                            
                                        </div>
                                    </div>
                                    <!-- //list -->
                                
                                    <!-- add -->
                                    <div class="addbox">
                                        <div class="txt">or <span>Add</span> new NameSpace</div>
                                        <button name="" value="" class="btn_add" id="btnToggleNamespace">ADD +</button> 
                                    </div>
                                
                                    <div class="add_ipbox" id="addNamespaceForm">
                                    
                                        <div class="iplist">
                                            <ul>
                                                <li><label class="chk">Type New NS Name</label><input type="text" name="" id="addNamespace" value="" placeholder="Input Name" title="" /></li>
                                                <li>
                                                    <label>Type Description</label>
                                                    <textarea  cols="" rows="" placeholder="Input Description" id="addNamespaceDesc" title=""></textarea>
                                                </li>
                                            </ul>
                                        
                                            <div class="btnbox">
                                                <button name="" value="" class="btn_create" id="ns_create_btn" onclick="createNameSpace()">Create</button>
                                                <button name="" value="" class="btn_clear">Clear</button>
                                            </div>
                                            
                                        </div>                                    
                                    </div>
                                    <!-- //add -->                                
                                </div>
                            </div>
                            <!-- //Select NS (NameSpace) -->
                        
                        </div>                    
                    
                        <button id="select_ns_ok_btn" name="" value="" class="btn_ok" data-dismiss="modal" onclick="clickOK();">OK</button> 
						
					</div>
					<!-- //list -->
					
					

				</div>
				<!-- //contents -->
<script >
// 유저의 namespace 목록 조회
function getNameSpaceList(){
    var url = "/setting/namespaces/namespace/list";
    // token
    axios.get(url,{
        // headers:{
        //     'Authorization': "{{ .apiInfo}}",
        //     'Content-Type' : "application/json"
        // }
    }).then(result=>{
        console.log("get NameSpace Data : ",result.data);        
        var data = result.data.NameSpaceList;
        var html = ""

        if( data.length > 0) {
            data.filter((list)=> list.name !== "" ).map((item,index)=>(
                html += '<div class="list" onclick="selectNS(\''+item.id+'\');">'
                    +'<div class="stit">'+item.name+'</div>'
                    +'<div class="stxt">'+item.description+' </div>'
                    +'</div>'                
            ))
            $("#nsList").empty();
            $("#nsList").append(html);
        }
    }) .catch(function (error) {
        if (error.response) {
            // 서버가 2xx 외의 상태 코드를 리턴한 경우
        //error.response.headers / error.response.status / error.response.data
            alert("There is a problem communicating with cb-tumblebug server\nCheck the cb-tumblebug server\nCall Url : " + url + "\nStatus Code : " + error.response.status);
        }
        else if (error.request) {
            // 응답을 못 받음
            alert("No response was received from the cb-tumblebug server.\nCheck the cb-tumblebug server\nCall Url : " + url);
        }
        else {
            alert("Error communicating with cb-tumblebug server.\n" + error.message);
        }
        //console.log(error.config);
    })
}



function createNameSpace(){
    var addNamespaceValue = $("#addNamespace").val()
    var addNamespaceDescValue = $("#addNamespaceDesc").val()
    
    //var url = "/ns";
    var url = "/setting/namespaces/namespace/reg/proc";
    var obj = {
        name: addNamespaceValue,
        description : addNamespaceDescValue
    }
    console.log(obj)
    if(addNamespaceValue){
        axios.post(url,obj,{
            headers: { 
                'Content-type': 'application/json',
                // 'Authorization': apiInfo, 
            }
        }).then(result =>{
            console.log(result);
            if(result.status == 200 || result.status == 201){
                var namespaceList = result.data.nsList;
                getUserNamespace(namespaceList)
                
                alert("Success Create NameSpace")

                // getNameSpaceList();
                $("#btnToggleNamespace").click()
                $("#namespace").val('')
                $("#nsDesc").val('')
            }else{
                alert("Fail Create NameSpace")
            }
        }).catch(function (error) {
            if (error.response) {
                // 서버가 2xx 외의 상태 코드를 리턴한 경우
            //error.response.headers / error.response.status / error.response.data
                alert("There is a problem communicating with cb-tumblebug server\nCheck the cb-tumblebug server\nCall Url : " + url + "\nStatus Code : " + error.response.status);
            }
            else if (error.request) {
                // 응답을 못 받음
                alert("No response was received from the cb-tumblebug server.\nCheck the cb-tumblebug server\nCall Url : " + url);
            }
            else {
                alert("Error communicating with cb-tumblebug server.\n" + error.message);
            }
            //console.log(error.config);
        });
    }else{
        alert("Input NameSpace")
        $("#addNamespace").focus()
        return;
    }
}
</script>
{{template "Footer" .}}
